# 실습

## 요구사항 명세

- 회원가입 기능
  - 회원가입을 할 때 이메일, 비밀번호, 이름, 나이의 정보를 받는다.
- 로그인 기능
  - 로그인할 때 이메일, 비밀번호를 활용해서 로그인한다.
- 게시글 작성 기능
  - 로그인한 사용자만 게시글을 작성할 수 있다.
  - 게시글에는 제목과 내용을 작성할 수 있고, 해시태그를 달 수 있고, 게시글의 카테고리(정보 게시글, 홍보 게시글 등)를 고를 수 있다.
- 게시글 조회 기능
  - 작성자, 게시글 제목, 게시글 내용, 게시글 작성 시간, 좋아요 수, 조회 수를 조회할 수 있어야 한다.
- 해시태그로 게시글 조회 기능
  - 특정 해시태그를 가진 모든 게시글을 조회할 수 있어야 한다.
- 좋아요 기능
  - 로그인한 사용자가 특정 게시글에 좋아요를 누를 수 있다.
  - 로그인한 사용자가 특정 게시글에 좋아요 취소를 할 수 있다.
  - 특정 게시글에 어떤 사용자들이 좋아요를 눌렀는 지 조회할 수 있어야 한다.
- 팔로우 기능
  - 특정 사용자가 다른 사용자를 팔로우 할 수 있다.
  - 특정 사용자가 다른 사용자를 언팔로우 할 수 있다.
  - 각 사용자의 팔로우 수를 조회할 수 있어야 한다.
- 신고 기능
  - 로그인한 사용자가 특정 게시글을 신고할 수 있다.
  - 신고할 때 신고 사유를 작성해야 한다.

## DB 설계 과정

### 1. 저장할 데이터를 파악해 보자

- 이메일, 비밀번호, 이름, 나이
- 게시글 제목, 내용, 해시태그, 게시글 카테고리
- 작성자, 게시글 작성 시간, 좋아요 수, 조회 수
- 팔로우 명단, 팔로우 수
- 신고, 신고 사유, 신고 게시글
- ex) https://docs.google.com/spreadsheets/d/1r7DXdGr9UpyHbyuQANvd_vv8Ask9RhJUYHEwa3Uf_Yk/edit?usp=sharing

### 2. 그룹핑 진행

- https://app.diagrams.net (도구)
- 이메일, 이름, 나이, 비밀번호 : `사용자`
- 내용, 제목, 시간, 해시태그, 좋아요 수, 작성자, 조회수, 카테고리 : `게시글`
- 누가 팔로우를 했는지 명단, 누구를 팔로우 했는지 : `팔로우`
- 신고 작성자, 신고 대상 게시글, 신고 사유 : `신고`
- 엑셀, 구글시트 등으로 표작업을 함

### 3. 각각의 테이블에서 각 내용 체크를 해본다.

- `데이터가 중복되면 안된다.`
- `하나의 값에 여러개가 들어가면 안된다.`
- 위 내용을 테스트하기 위해서는 더미 데이터 3~4개를 입력해서 테스트한다.

### 4. 사용자 테이블을 테스트 해보자

- 가짜 데이터 3~4개를 넣어보면서 잘 구성하였는지 검토

- 이메일 항목은 중복되지 않는다.
- 이메일 값으로 한개만 받는다.
- 비밀번호 항목은 중복을 허용해도 된다. (하나의 값이 바뀌어도 다른 값 영향없음)
- 비밀번호 값으로 한개만 받는다.
- 이름 항목은 중복을 허용해도 된다. (하나의 값이 바뀌어도 다른 값 영향없음)
- 이름 값으로 한개만 받는다.
- 나이 항목은 중복을 허용해도 된다. (하나의 값이 바뀌어도 다른 값 영향없음)
- 나이 값으로 한개만 받는다.
- `결론적으로 잘 설계가 되었다.`

### 5. 게시글 테이블을 테스트 해보자

- 내용 항목은 중복을 허용해도 된다. (하나의 값이 바뀌어도 다른 값 영향없음)
- 내용 값으로 한개만 받는다.
- 제목 항목은 중복을 허용해도 된다. (하나의 값이 바뀌어도 다른 값 영향없음)
- 제목 값으로 한개만 받는다.
- 시간 항목은 중복을 허용해도 된다. (하나의 값이 바뀌어도 다른 값 영향없음)
- 시간 값으로 한개만 받는다.
- 해시태그 항목은 중복을 허용하면 안된다. (ex: 건강 -> Health 로 변경시 찾아서 모두 고쳐야 함)
- 해시태그 값 중복으로 여러개가 입력되고 있다. (별도의 표를 만들어야 함)
- 카테고리 항목은 중복을 허용하면 안된다. (ex: 건강 -> Health 로 변경시 찾아서 모두 고쳐야 함)
- 카테고리 값으로 한개만 받는다.
- 조회수 항목은 중복을 허용해도 된다. (`고민해 보니 생각보다 연결된 곳이 많다` ex. 누가 몇 번을 눌렀는지)
- 조회수 값으로 한개만 받는다. (`단순한 숫자가 아니라 통계적인 합산 값이 들어감`)
- 작성자 항목은 중복을 허용하면 안된다. (ex. 홍길동 -> 김길동 변경시 여러 곳 수정)
- 작성자 값으로 한개만 받는다.
- 좋아요의 경우는 실제로 중복을 허용하면 안된다. (`고민해 보니 생각보다 연결된 곳이 많다` ex. 누가 좋아요를 눌렀는지)
- 좋아요 값으로 한개만 받는다. (`단순한 숫자가 아니라 통계적인 합산 값이 들어감`)

#### 5.1. 해시태그는 표를 별도로 생성하자

- 게시글은 해시태그가 있다.
- 해시태그는 게시글에 있다.
- 하나의 게시글은 여러 개의 해시태그가 있다.
- 여러 개의 해시태그는 여러 개의 게시글에 있다.
- 게시글 : 해시태그 = N : M
- 중간 FK 를 모은 표가 필요하다.

#### 5.2. 카테고리는 표를 별도로 생성하자

- 게시글에는 카테고리가 있다.
- 카테고리는 게시글에 표현된다.
- 하나의 게시글에는 하나의 카테고리가 있다.
- 하나의 카테고리는 여러 게시글에 표현된다.
- 게시글 : 카테고리 = N : 1 관계
- 표를 하나 추가한다.
- `FK 는 N  테이블에 작성한다.`

#### 5.3. 좋아요는 표를 별도로 생성하자

- 누가 좋아요 눌렀는지 기록
- 어떤 게시글을 좋아요 눌렀는지 기록
- 값을 한번 넣어보자
- 하나의 칸에 여러 개가 들어감 (규칙 어긋남)
- 게시글에는 누가 좋아요 했는지 있다.
- 누가 좋아요 했는지는 게시글에 있다.
- 하나의 게시글에는 여러 명의 누가 좋아했는지가 있다.
- 한 명의 사용자는 여러 개의 게시글에 좋아요 할 수 가 있다.
- 게시글 : 좋아요 = N : M
- 그래서 FK 를 모은 중간 테이블이 필요하다.

#### 5.4. 조회수는 표를 별도로 생성하자

- 누가 글을 읽었는지 기록
- 어떤 게시글을 읽었는지 기록
- 값을 한번 넣어보자
- 하나의 칸에 여러 개가 들어감 (규칙 어긋남)
- 게시글을 누가 읽었는지 있다.
- 누가 읽었는지는 게시글에 있다.
- 하나의 게시글에는 여러 명이 읽을 수 있다.
- 한 명의 사용자는 여러 개의 게시글을 조회 할 수 가 있다.
- 게시글 : 조회수 = N : M
- 그래서 FK 를 모은 중간 테이블이 필요하다.

### 6. 팔로우 테이블을 테스트 해보자

- 사용자는 다른 사용자를 팔로우 한다.
- 사용자는 다른 사용자를 언팔로우 한다.
- 한 명의 사용자는 여러 명의 사용자를 팔로우 할 수 있다.
- 여러 명의 사용자는 한 명의 사용자를 팔로우 할 수 있다.
- 팔로워 : 언팔로워 = N : M
- 중간표 (FK)

### 7. 신고 테이블을 테스트 해보자

- 신고글은 그대로 둠

## 최종 테이블 구조

- 늘 변합니다.
- https://docs.google.com/spreadsheets/d/1r7DXdGr9UpyHbyuQANvd_vv8Ask9RhJUYHEwa3Uf_Yk/edit?usp=sharing
